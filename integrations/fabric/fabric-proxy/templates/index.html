{% extends "base.html" %}

{% block title %}Fabric Pattern Library - {{ pattern_count }} AI Patterns{% endblock %}

{% block extra_styles %}
<style>
    /* Hero Section */
    .hero {
        text-align: center;
        padding: 3rem 0;
        margin-bottom: 2rem;
    }

    .hero h1 {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 1rem;
        background: linear-gradient(135deg, #60A5FA, #3B82F6);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .hero p {
        color: var(--text-secondary);
        font-size: 1.125rem;
        max-width: 600px;
        margin: 0 auto;
    }

    /* Category Filters */
    .category-filters {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 1.5rem;
    }

    .category-btn {
        padding: 0.5rem 1rem;
        border-radius: 8px;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        border: 1px solid rgba(255, 255, 255, 0.1);
        background: var(--bg-card);
        color: var(--text-secondary);
        transition: all 0.2s ease;
    }

    .category-btn:hover,
    .category-btn.active {
        background: rgba(59, 130, 246, 0.2);
        border-color: var(--accent-ai-blue);
        color: var(--text-primary);
    }

    .category-btn.custom-btn {
        border-color: rgba(168, 85, 247, 0.3);
    }

    .category-btn.custom-btn:hover,
    .category-btn.custom-btn.active {
        background: rgba(168, 85, 247, 0.2);
        border-color: #A855F7;
        color: #C084FC;
    }

    /* Pattern Grid */
    .pattern-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1rem;
    }

    .pattern-card {
        padding: 1.25rem;
        cursor: pointer;
        text-decoration: none;
        color: inherit;
    }

    .pattern-name {
        font-weight: 600;
        font-size: 1rem;
        color: var(--text-primary);
        margin-bottom: 0.5rem;
        font-family: 'SF Mono', Monaco, monospace;
    }

    .pattern-category {
        margin-bottom: 0.75rem;
    }

    .pattern-preview {
        font-size: 0.8125rem;
        color: var(--text-muted);
        line-height: 1.5;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    /* Stats Bar */
    .stats-bar {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
        font-size: 0.875rem;
        color: var(--text-muted);
    }

    .stats-bar span {
        padding: 0.5rem 1rem;
        background: var(--bg-card);
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* No Results */
    .no-results {
        text-align: center;
        padding: 3rem;
        color: var(--text-muted);
    }

    .no-results svg {
        width: 48px;
        height: 48px;
        margin-bottom: 1rem;
        opacity: 0.5;
    }
</style>
{% endblock %}

{% block content %}
<div class="hero animate-fadeIn">
    <h1>Fabric Pattern Library</h1>
    <p>Explore {{ pattern_count }} battle-tested AI patterns for content processing, analysis, and generation.</p>
</div>

<!-- Search -->
<div class="search-container">
    <svg class="search-icon" width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
    </svg>
    <input type="text" class="search-input" id="searchInput" placeholder="Search patterns... (e.g., summarize, extract, analyze)" autocomplete="off">
</div>

<!-- Category Filters -->
<div class="category-filters" id="categoryFilters">
    <button class="category-btn active" data-category="all">All</button>
    <button class="category-btn custom-btn" data-category="custom">Custom ({{ custom_count }})</button>
    <button class="category-btn" data-category="extract">Extract</button>
    <button class="category-btn" data-category="analyze">Analyze</button>
    <button class="category-btn" data-category="create">Create</button>
    <button class="category-btn" data-category="summarize">Summarize</button>
    <button class="category-btn" data-category="improve">Improve</button>
    <button class="category-btn" data-category="write">Write</button>
    <button class="category-btn" data-category="utility">Utility</button>
</div>

<!-- Stats -->
<div class="stats-bar">
    <span id="resultCount">Showing {{ pattern_count }} patterns</span>
</div>

<!-- Pattern Grid -->
<div class="pattern-grid" id="patternGrid">
    {% for pattern in patterns %}
    <a href="/view/{{ pattern.name }}" class="card pattern-card" data-name="{{ pattern.name }}" data-category="{{ pattern.category }}">
        <div class="pattern-name">{{ pattern.name }}</div>
        <div class="pattern-category">
            <span class="badge badge-{{ pattern.badge_type }}">{{ pattern.category|upper }}</span>
        </div>
        <div class="pattern-preview">{{ pattern.preview }}</div>
    </a>
    {% endfor %}
</div>

<!-- No Results Message -->
<div class="no-results" id="noResults" style="display: none;">
    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
    </svg>
    <p>No patterns found matching your search.</p>
</div>
{% endblock %}

{% block scripts %}
<script>
    const searchInput = document.getElementById('searchInput');
    const patternGrid = document.getElementById('patternGrid');
    const categoryFilters = document.getElementById('categoryFilters');
    const resultCount = document.getElementById('resultCount');
    const noResults = document.getElementById('noResults');
    const patterns = document.querySelectorAll('.pattern-card');

    let activeCategory = 'all';

    function filterPatterns() {
        const searchTerm = searchInput.value.toLowerCase();
        let visibleCount = 0;

        patterns.forEach(card => {
            const name = card.dataset.name.toLowerCase();
            const category = card.dataset.category.toLowerCase();

            const matchesSearch = name.includes(searchTerm);
            const matchesCategory = activeCategory === 'all' || category.includes(activeCategory);

            if (matchesSearch && matchesCategory) {
                card.style.display = 'block';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        resultCount.textContent = `Showing ${visibleCount} patterns`;
        noResults.style.display = visibleCount === 0 ? 'block' : 'none';
        patternGrid.style.display = visibleCount === 0 ? 'none' : 'grid';
    }

    searchInput.addEventListener('input', filterPatterns);

    categoryFilters.addEventListener('click', (e) => {
        if (e.target.classList.contains('category-btn')) {
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            activeCategory = e.target.dataset.category;
            filterPatterns();
        }
    });

    // Focus search on page load
    searchInput.focus();
</script>
{% endblock %}
